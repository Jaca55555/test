<!DOCTYPE html>
<html xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <object th:include="fragments/includes_top :: top" th:remove="tag" ></object>
    <style>
        .ck-editor__editable_inline {
            min-height: 200px;
            color: black;
        }
    </style>
</head>
<body>
<!-- [ Pre-loader ] start -->
<div class="loader-bg">
    <div class="loader-track">
        <div class="loader-fill"></div>
    </div>
</div>
<!-- [ Pre-loader ] End -->

<object th:include="fragments/navigation_menu :: menu" th:remove="tag" ></object>

<object th:include="fragments/header :: head" th:remove="tag" ></object>

<!-- [ Main Content ] start -->
<div class="pcoded-main-container">
    <div class="pcoded-wrapper">
        <div class="pcoded-content">
            <div class="pcoded-inner-content">
                <div class="main-body">
                    <div class="page-wrapper">
                        <!-- [ Main Content ] start -->
                        <div class="row">
                            <!-- [ sample-page ] start -->
                            <div class="col-sm-12">
                                <div class="card">
                                    <div class="card-header">
                                        <h5>appeal.view</h5>
                                    </div>
                                    <div class="card-body">
                                        <div class="row" th:object="${appeal}">

                                            <div class="col-md-4 col-sm-4 col-xs-12 mb-3">
                                                <label class="control-label text-dark" th:text="#{appeal.type}">English</label>
                                                <p>
                                                    <span th:text="*{appealType}"></span>
                                                </p>
                                            </div>

                                            <div class="col-md-4 col-sm-4 col-xs-12 mb-3">
                                                <label class="control-label text-dark" th:text="#{appeal.status}">English</label>
                                                <p>
                                                    <span th:if="*{appealStatus==T(uz.maroqand.ecology.core.constant.sys.AppealStatus).Open}" class="badge badge-secondary" th:text="*{appealStatus}"></span>
                                                    <span th:if="*{appealStatus==T(uz.maroqand.ecology.core.constant.sys.AppealStatus).InProgress}" class="badge badge-primary" th:text="*{appealStatus}"></span>
                                                    <span th:if="*{appealStatus==T(uz.maroqand.ecology.core.constant.sys.AppealStatus).Closed}" class="badge badge-success" th:text="*{appealStatus}"></span>
                                                </p>
                                            </div>

                                            <div class="col-md-4 col-sm-4 col-xs-12 mb-3">
                                                <label class="control-label text-dark" th:text="#{appeal.createdBy}">English</label>
                                                <p th:if="${createdBy.firstname!=null && createdBy.lastname!=null && createdBy.middlename!=null}" th:text="${createdBy.lastname+' '+createdBy.firstname+' '+createdBy.middlename}"></p>
                                                <p th:if="${createdBy.firstname==null && createdBy.lastname==null && createdBy.middlename==null}"></p>
                                            </div>

                                            <div class="col-md-4 col-sm-4 col-xs-12 mb-3">
                                                <label class="control-label text-dark" th:text="#{appeal.phone}">English</label>
                                                <p th:text="*{phone}"></p>
                                            </div>

                                            <div class="col-md-4 col-sm-4 col-xs-12 mb-3">
                                                <label class="control-label text-dark" th:text="#{appeal.title}">English</label>
                                                <p th:text="*{title}"></p>
                                            </div>

                                            <div class="col-md-4 col-sm-4 col-xs-12 mb-3">
                                                <label class="control-label text-dark" th:text="#{appeal.createdAt}"></label>
                                                <p th:text="*{#dates.format(createdAt,'dd:MM:yyyy HH:mm')}"></p>
                                            </div>

                                            <div class="col-md-12 col-sm-12 col-xs-12">
                                                <div class="row">
                                                    <!-- Description and comments-->
                                                    <div class="col-md-3 col-sm-3 col-xs-12"></div>
                                                    <div class="col-md-6 col-sm-6 col-xs-12">
                                                        <h5 th:text="#{appeal.content}"></h5><hr>
                                                        <div class="alert alert-dark rounded" th:utext="*{description}"></div>
                                                        <div th:if="${#lists.size(appealSubList)>0}">
                                                            <h5 th:text="#{appeal.comments}"></h5><hr>
                                                        </div>

                                                        <div class="media alert alert-success text-dark rounded" th:each="comment : ${appealSubList}">
                                                            <div class="media-left mr-3">
                                                                <i class="fas fa-user fa-2x" style="color:#299b85"></i>
                                                            </div>
                                                            <div class="media-body">
                                                                <h6 class="media-heading txt-primary">
                                                                    <span th:text="${@helperService.getUserFullNameById(comment.createdById )}"></span>
                                                                    <span th:text="${#dates.format(comment.createdAt,'dd.MM.yyyy HH:mm')}"></span>
                                                                </h6>

                                                                <p th:utext="${comment.message}"></p>

                                                                <p th:if="${comment.inProgress == true}">
                                                                    <span th:text="#{inProgress}" style="color:#299b85"></span>
                                                                </p>

                                                                <p th:if="${comment.closed == true}">
                                                                    <span th:text="#{Closed}" style="color:#299b85"></span>
                                                                </p>
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <div class="col-md-3 col-sm-3 col-xs-12"></div>

                                                    <!-- Add new comments-->
                                                    <div class="col-md-3 col-sm-3 col-xs-12"></div>
                                                    <div class="col-md-6 col-sm-6 col-xs-12" th:if="*{appealStatus!=T(uz.maroqand.ecology.core.constant.sys.AppealStatus).Closed}">
                                                        <h5 th:text="#{appeal.addComment}"></h5><hr>
                                                        <form th:action="${action_url}" method="post" th:object="${appealSub}">
                                                            <textarea class="form-control col-md-12 col-xs-12" name="description" id="description" type="text" rows="8" th:field="*{message}"/>
                                                            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
                                                            <input type="hidden" th:value="${appeal.id}" name="appealId"/>
                                                            <div class="form-group row text-center mt-3">
                                                                <div class="col-sm-12">
                                                                    <a class="btn btn-danger" th:href="${cancel_url}" th:text="#{sys_cancel}"></a>
                                                                    <input type="submit" th:value="#{sys_add}" class="btn btn-primary"/>
                                                                </div>
                                                            </div>
                                                        </form>
                                                    </div>
                                                    <div class="col-md-3 col-sm-3 col-xs-12"></div>

                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- [ sample-page ] end -->
                        </div>
                        <!-- [ Main Content ] end -->
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- [ Main Content ] end -->


<object th:include="fragments/includes_bottom :: bottom" th:remove="tag" ></object>
<script src="/static/plugins/ckeditor/js/ckeditor.js"></script>
<script type="text/javascript">
    ClassicEditor.create(document.querySelector( '#description' )).catch( error => {console.error( error )});
</script>
</body>
</html>